# ArchivesSpace Sitemap Generation for the PUI

## Getting started

Download and unpack the latest release of the plugin into your
ArchivesSpace plugins directory:

```
    $ curl ...
    $ cd /path/to/archivesspace/plugins
    $ unzip ...
```

Add the plugin name to the list of enabled plugins in `config/config.rb`:

```
AppConfig[:plugins] = ['some_plugin','aspace_sitemap']
```
### Note
For users running ArchivesSpace versions older than v2.6.0, please note that slug related options are not available.

## What does it do?
The plugin adds a new job that generates a sitemap (or sitemaps with a sitemap index)
for the PUI. The file(s) can be downloaded and placed on a server of your choice for submission
to the search engine(s) of choice.There are a number of configuration options

## Configuration

Configure the plugin by editing your `config.rb` file with the 
following entries - modified as appropriate.

1) Set the default limit on the number of entries within each sitemap. 
If the total number of published objects is larger than the limit, 
multiple sitemaps together with a sitemap index file will be generated.
Google allows 50000 entries or 50MB per file. Each entry is fairly lean,
so should not exceed the 50MB limit even when set to 50000 entries per sitemap.
```
# Google currently allows up to 50000 urls or up to a 50MB file size.
AppConfig[:aspace_sitemap_default_limit] = 50000
```
2) Google requires verification that you own the site. 
One way is by a verification meta tag.
```
# set the meta tag from Google to verify site ownership
AppConfig[:google_verification_meta_tag] = "your_verification_meta_tag"
```
3) Bing also requires verification that you own the site. 
One way is by a verification meta tag.
```
# set the meta tag from Bing to verify site ownership
AppConfig[:bing_verification_meta_tag] = "your_verification_meta_tag"
```
## How to Use
For users with access to `Background Jobs`, there is a new entry in the `Create Jobs` menu called `ArchivesSpace PUI Sitemap` Once selected, the job asks for several inputs

1. The sitemap index base url. This is the location where you will be hosting the sitemaps. It is ignored if write to filesystem (below) is selected.
2. The limit on the number of entries per sitemap file. You should be able to leave this at the default of 50000.
3. What types of objects to include in the sitemap. At least one is required.
4. The update frequency. For most institutions, yearly is probably fine.
5. Use human readable slugs. Slugs generated by the user or the application will be used in the `<loc>` field if they are available.
6. Write to local filesystem. Sitemaps will be written to a publicly accessible space. This builds on the static_pages plugin from Hudson Molonglo 
[https://github.com/hudmol/static_pages](https://github.com/hudmol/static_pages) and makes the generated sitemaps accessible by pointing Google or other to `{pui_host}/static/html/aspace_sitemap_index.xml`

## Notes
1. The 'priority' key is not used in the sitemap since there is no mechanism in place to mark
objects in the staff interface. Given the large number of objects that are typically
published, it seems unlikely that 'priority' would be widely used.
2. The option to use slug/human readable urls is somewhat risky, since these slugs are based on **changeable** metadata.

Joshua Shaw (<Joshua.D.Shaw@Dartmouth.EDU>)  
Digital Library Technologies Group  
Dartmouth College Library  
